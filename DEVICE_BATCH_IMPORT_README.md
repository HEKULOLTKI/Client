# 设备批量导入功能说明

## 新增功能

本次更新为设备管理添加了以下新功能：

### 1. 设备管理对话框升级
- 改为标签页模式，支持单个添加和批量导入
- 单个添加支持连续添加，无需重复打开对话框
- 添加清空表单功能，方便快速重新输入

### 2. 批量导入功能
- 支持 Excel (.xlsx) 和 CSV (.csv) 格式文件
- 提供导入模板下载功能
- 文件预览功能，导入前可查看数据
- 实时进度显示

### 3. 模板格式

导入模板包含以下列：
- **设备名称** (必填)：设备的名称
- **设备类型** (可选)：路由器、交换机、防火墙等
- **IP地址** (可选)：设备的IP地址
- **设备位置** (可选)：设备物理位置
- **设备状态** (可选)：online, offline, maintenance

## 使用方法

### 单个设备添加
1. 点击桌面管理器的"添加设备"按钮
2. 在"单个添加"标签页填写设备信息
3. 点击"添加并继续"按钮
4. 表单自动清空，可继续添加下一个设备
5. 点击"关闭"按钮结束添加

### 批量设备导入
1. 点击桌面管理器的"添加设备"按钮
2. 切换到"批量导入"标签页
3. 点击"下载导入模板"按钮，保存模板文件
4. 在Excel或其他编辑器中填写设备信息
5. 点击"选择导入文件"选择填写好的文件
6. 预览表格确认数据正确
7. 点击"导入批量设备"开始导入
8. 等待导入完成

## 注意事项

1. **必填字段**：设备名称为必填项，其他字段可为空
2. **状态值**：设备状态只能为 online、offline、maintenance 中的一个
3. **文件编码**：CSV文件请使用UTF-8编码
4. **数据验证**：导入前会自动验证和格式化数据
5. **错误处理**：导入失败的设备会在日志中显示原因

## 依赖要求

确保安装以下Python包：
```bash
pip install pandas openpyxl
```

或使用requirements.txt：
```bash
pip install -r requirements.txt
```

## 技术特性

- 异步处理：导入过程不会阻塞界面
- 进度显示：实时显示导入进度
- 错误恢复：单个设备失败不影响其他设备导入
- 内存优化：大文件分批处理，避免内存溢出
- 连续添加：单个添加模式支持快速连续操作 